!function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";t.r(r);var n=function(e){return Object.prototype.toString.call(e).slice(8,-1)};function o(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.processError(r)}var r,t,a;return r=e,(t=[{key:"processError",value:function(e){if(this.logId,this.errorLevel,this.timestamp=Date.now(),"ErrorEvent"===n(e)){this.filename=e.filename,this.lineNo=e.lineno,this.colNo=e.colno;var r=e.message.split(": ");this.errorType=r[0]&&r[0].replace('"',""),this.message=r[1]&&r[1].replace('"',"")}if("Event"===n(e)&&e.target&&e.target.localName){var t=e.target,o=t.localName;this.filename="script"===o||"img"===o?t.src:t.href,this.message="".concat(this.filename," load error"),this.errorType="LoadError"}"PromiseRejectionEvent"===n(e)&&console.log(e),n(e)}}])&&o(r.prototype,t),a&&o(r,a),e}();var i=function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.screen={width:window.screen.width,height:window.screen.height},this.userAgent=window.navigator.userAgent,this.path=window.location.href};function c(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientInfo=new i,this.performance=this.getPerformance(),this.resources=this.getResources()}var r,t,n;return r=e,(t=[{key:"getPerformance",value:function(){var e=(window.performance||window.msPerformance||window.webkitPerformance).timing;return{whiteScreen:e.responseStart-e.fetchStart,firstScreen:e.domInteractive-e.fetchStart,userOperable:e.domContentLoadedEventEnd-e.fetchStart,loadEnd:e.domComplete-e.fetchStart}}},{key:"getResources",value:function(){var e=(window.performance||window.msPerformance||window.webkitPerformance).getEntries(),r={xmlhttprequest:[],css:[],other:[],script:[],img:[],link:[],fetch:[]};return e.forEach((function(e){r[e.initiatorType]&&r[e.initiatorType].push({name:e.name,duration:"".concat(parseInt(e.duration),"ms"),size:e.transferSize,protocol:e.nextHopProtocol})})),r}}])&&c(r.prototype,t),n&&c(r,n),e}();function u(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=r,this.baseUrl=r.baseUrl}var r,t,n;return r=e,(t=[{key:"ajax",value:function(e,r,t){var n=this,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.config.header,i=null;return window.XMLHttpRequest?i=new XMLHttpRequest:window.ActiveXObject&&(i=new ActiveXObject("Microsoft.XMLHttp")),new Promise((function(c,s){var u=e.toUpperCase(),l=[];for(var f in t)t.hasOwnProperty(f)&&l.push("".concat(f,"=").concat(t[f]));var p="GET"===u?"".concat(r,"?").concat(l.join("&")):r;if(i.open(u,"".concat(n.baseUrl).concat(p),o),a&&"POST"===u)for(var h in a)a.hasOwnProperty(h)&&i.setRequestHeader(h,a[h]);i.onreadystatechange=function(){4===i.readyState&&(200==i.status?c(i.responseText):s({code:i.status,response:i.responseText},this))},i.send("GET"===u&&t?null:JSON.stringify(t))}))}},{key:"get",value:function(e){return this.ajax("GET",e.url,e.data)}},{key:"post",value:function(e){return this.ajax("POST",e.url,e.data)}},{key:"img",value:function(e){var r=e.url,t=e.data,n=new Image;n.onload=n.onerror=n.onabort=function(){n=n.onload=n.onerror=n.onabort=null};var o=[];for(var a in t)t.hasOwnProperty(a)&&o.push("".concat(a,"=").concat(t[a]));n.src="".concat(this.baseUrl).concat(r,"?").concat(encodeURI(o.join("&")))}}])&&u(r.prototype,t),n&&u(r,n),e}();function f(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function p(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?f(Object(t),!0).forEach((function(r){h(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function h(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function d(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var w=function(){function e(r){var t=this;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=Object.assign({},r),this.reportData={page_url:window.location.href,project_id:this.config.projectId,user_agent:window.navigator.userAgent},this.http=new l({baseUrl:this.config.reportUrl}),this.browse=new s,this.errors=[];var n=setTimeout((function(){t.config.reports.includes("report_page_speed")&&t.reportBrowse(),t.reportUserBehavior(),clearTimeout(n)}),0)}var r,t,n;return r=e,(t=[{key:"initErrorListener",value:function(){var e,r=this;window.addEventListener("error",(function(e){console.log(e),e.cancelable&&e.filename.indexOf("monitor.sdk")>-1||r.errorReport(e)}),!0),window.addEventListener("unhandledrejection",(function(e){e.preventDefault(),console.log(e.reason),r.errorReport(e)})),Promise.prototype.catch=(e=Promise.prototype.catch,function(r){var t;return arguments[0]=(t=arguments[0],function(e){return console.log("探针捕获到的error: ",e),t.apply(this,arguments)}),e.apply(this,arguments)}),window.Vue&&(Vue.config.errorHandler=function(e,t,n){r.errorReport(e)})}},{key:"report",value:function(e,r){if(console.group(JSON.parse(r)),window&&window.navigator&&"function"==typeof window.navigator.sendBeacon)navigator.sendBeacon(e,r);else{var t=new Image;t.onload=t.onerror=t.onabort=function(){t=t.onload=t.onerror=t.onabort=null},t.src="".concat(e,"?msg=").concat(r)}}},{key:"reportBrowse",value:function(){var e=this.browse.performance;this.http.img({url:"/performance_up",data:p(p({},this.reportData),{},{blank_time:e.whiteScreen,first_screen_time:e.firstScreen,operational_time:e.userOperable,alldownload_time:e.loadEnd})})}},{key:"reportUserBehavior",value:function(){this.http.img({url:"/report_user_behavior",data:p({},this.reportData)})}},{key:"errorReport",value:function(e){console.log(new a(e))}}])&&d(r.prototype,t),n&&d(r,n),e}();window.Monitor=w}]);